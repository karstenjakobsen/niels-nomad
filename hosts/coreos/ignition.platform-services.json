{"passwd": {"users": [{"sshAuthorizedKeys": ["ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAACAQCjcbd8KEujzX8cieLbd6TBsRS2mOdGf1FuQNPC22Ucg/qn0/aG8UK3/ZAhMw2RhhVObr5G2gnTxzcmQwDpnZ2rEK3QA2MoYM1NBYFmkqUudZED4Kf/CxBCH51l42Dmux50GMxdNR0bkjSH1R1f8CQwrIpiDXYLncihlXvGZy0IzVGBvML5gIcrIW3LflJu/LyjY7IbvA6t5GCNCnuFV56wUcfhcGMHpyX1If8w5+/DLmTcAS3I0120yWLw3k/+rS/TProJzIbzn9sNaKvsk6dJQw1aOANKSPrZ28//uYhPsq3qTwfhuzYjLEezd+w4uJOF4rKE5/o1r4Y4a1mnCzLtVMSxwUR7tP0ljXztRGovBtbgfEEri8ONpRCWYdHpVqUCaozW+2uQKwoccgZ4SJl3uqx60Xrqao625Mxoc86EnfTlq7N91mJJ3Nc33z+emKRrnE7P0Eh1k/RAW85AXIUDJbt5Fc20ATRiTOVLGpJTkrAphm+JHcaoo+YKzypR3r6upwsJVX1yXa8kBoSGbouAghAuRKx/IgEodSolIKDnq8KagJmBwXG9ussJpYHW607ZEMzNwwsFFEMQxyLzrVDznPNk4C88tyzpnI9Yli54KUGNehFIn0RVyN015T3KpxHVP+iciwBTo7DtDRZyjI8dfbaG3fePVok4K5B4lOVg2w== cardno:000606334270"], "name": "kj", "groups": ["sudo", "docker"]}]}, "networkd": {"units": [{"name": "10-static.network", "contents": "[Match]\nName=ens192\n\n[Network]\nDNS=127.0.0.1\nDNS=8.8.8.8\nDNS=8.8.4.4\nDomains=\nAddress=192.168.10.10/24\nGateway=192.168.10.1"}]}, "storage": {"files": [{"path": "/etc/hostname", "mode": 420, "contents": {"source": "data:text/plain;charset=utf-8;base64,bnliMS1wbHQtc2VydmljZXMtMDAx"}, "filesystem": "root"}, {"path": "/etc/profile.d/10-path.sh", "mode": 420, "contents": {"source": "data:text/plain;charset=utf-8;base64,UEFUSD0vaG9tZS9jb3JlL2Jpbjovb3B0L2JpbjokUEFUSA=="}, "filesystem": "root"}, {"path": "/etc/sysctl.d/80-swappiness.conf", "mode": 420, "contents": {"source": "data:text/plain;charset=utf-8;base64,dm0uc3dhcHBpbmVzcz0xMA=="}, "filesystem": "root"}, {"path": "/etc/nomad/nomad.hcl", "mode": 420, "contents": {"source": "data:text/plain;charset=utf-8;base64,IyBJbmNyZWFzZSBsb2cgdmVyYm9zaXR5CmxvZ19sZXZlbCA9ICJJTkZPIgoKIyBTZXR1cCBkYXRhIGRpcgpkYXRhX2RpciA9ICIvdmFyL2xpYi9ub21hZCIKCmRhdGFjZW50ZXIgPSAibnliMSIKCnJlZ2lvbiA9ICJnbG9iYWwiCgpiaW5kX2FkZHIgPSAiMC4wLjAuMCIKCmFkdmVydGlzZSB7CiAgIyBEZWZhdWx0cyB0byB0aGUgZmlyc3QgcHJpdmF0ZSBJUCBhZGRyZXNzLgogIGh0dHAgPSAiMTkyLjE2OC4xMC4xMCIKICBycGMgID0gIjE5Mi4xNjguMTAuMTAiCiAgc2VyZiA9ICIxOTIuMTY4LjEwLjEwIiAjIG5vbi1kZWZhdWx0IHBvcnRzIG1heSBiZSBzcGVjaWZpZWQKfQoKIyBFbmFibGUgdGhlIGNsaWVudApjbGllbnQgewoKICAgIGVuYWJsZWQgPSB0cnVlCiAgICBzZXJ2ZXJzID0gWyJub21hZC5zZXJ2aWNlLmNvbnN1bDo0NjQ3Il0KCiAgICBtZXRhIHsKICAgICAgICAgICAgImVudiI9InBsYXRmb3JtIgogICAgICAgICAgfQoKICAgIG5ldHdvcmtfaW50ZXJmYWNlID0gImVuczE5MiIKCn0KCgpjb25zdWwgewogIGFkZHJlc3MgPSAiMTkyLjE2OC4xMC4xMDo4NTAwIgp9Cgp0ZWxlbWV0cnkgewogIGNvbGxlY3Rpb25faW50ZXJ2YWwgPSAiMXMiCiAgZGlzYWJsZV9ob3N0bmFtZSA9IHRydWUKICBwcm9tZXRoZXVzX21ldHJpY3MgPSB0cnVlCiAgcHVibGlzaF9hbGxvY2F0aW9uX21ldHJpY3MgPSB0cnVlCiAgcHVibGlzaF9ub2RlX21ldHJpY3MgPSB0cnVlCn0="}, "filesystem": "root"}, {"path": "/etc/dnsmasq/dnsmasq.conf", "mode": 420, "contents": {"source": "data:text/plain;charset=utf-8;base64,IyBFbmFibGUgZm9yd2FyZCBsb29rdXAgb2YgdGhlICdjb25zdWwnIGRvbWFpbiB0byBsb2NhbGlwOgpzZXJ2ZXI9L2NvbnN1bC8xOTIuMTY4LjEwLjEwIzg2MDAKCiMgRW5hYmxlIHJldmVyc2UgRE5TIGxvb2t1cHMgZm9yIGNvbW1vbiBuZXRibG9ja3MgZm91bmQgaW4gUkZDIDE5MTgsIDU3MzUsIGFuZCA2NTk4OgpyZXYtc2VydmVyPTAuMC4wLjAvOCwxOTIuMTY4LjEwLjEwIzg2MDAKcmV2LXNlcnZlcj0xMC4wLjAuMC84LDE5Mi4xNjguMTAuMTAjODYwMApyZXYtc2VydmVyPTEwMC42NC4wLjAvMTAsMTkyLjE2OC4xMC4xMCM4NjAwCnJldi1zZXJ2ZXI9MTI3LjAuMC4xLzgsMTkyLjE2OC4xMC4xMCM4NjAwCnJldi1zZXJ2ZXI9MTY5LjI1NC4wLjAvMTYsMTkyLjE2OC4xMC4xMCM4NjAwCnJldi1zZXJ2ZXI9MTcyLjE2LjAuMC8xMiwxOTIuMTY4LjEwLjEwIzg2MDAKcmV2LXNlcnZlcj0xOTIuMTY4LjAuMC8xNiwxOTIuMTY4LjEwLjEwIzg2MDAKCiMgQWNjZXB0IEROUyBxdWVyaWVzIG9ubHkgZnJvbSBob3N0cyB3aG9zZSBhZGRyZXNzIGlzIG9uIGEgbG9jYWwgc3VibmV0Lgpsb2NhbC1zZXJ2aWNlCgojIERvbid0IHBvbGwgL2V0Yy9yZXNvbHYuY29uZiBmb3IgY2hhbmdlcy4Kbm8tcG9sbAoKIyBEb24ndCByZWFkIC9ldGMvcmVzb2x2LmNvbmYuIEdldCB1cHN0cmVhbSBzZXJ2ZXJzIG9ubHkgZnJvbSB0aGUgY29tbWFuZAojIGxpbmUgb3IgdGhlIGRuc21hc3EgY29uZmlndXJhdGlvbiBmaWxlIChzZWUgdGhlICJzZXJ2ZXIiIGRpcmVjdGl2ZSBiZWxvdykuCm5vLXJlc29sdgoKIyBTcGVjaWZ5IElQIGFkZHJlc3MoZXMpIG9mIG90aGVyIEROUyBzZXJ2ZXJzIGZvciBxdWVyaWVzIG5vdCBoYW5kbGVkCiMgZGlyZWN0bHkgYnkgY29uc3VsLiBUaGVyZSBpcyBub3JtYWxseSBvbmUgJ3NlcnZlcicgZW50cnkgc2V0IGZvciBldmVyeQojICduYW1lc2VydmVyJyBwYXJhbWV0ZXIgZm91bmQgaW4gJy9ldGMvcmVzb2x2LmNvbmYnLiBTZWUgZG5zbWFzcSg4KSdzCiMgJ3NlcnZlcicgY29uZmlndXJhdGlvbiBvcHRpb24gZm9yIGRldGFpbHMuCnNlcnZlcj04LjguOC44CnNlcnZlcj04LjguNC40CgojIFNldCB0aGUgc2l6ZSBvZiBkbnNtYXNxJ3MgY2FjaGUuIFRoZSBkZWZhdWx0IGlzIDE1MCBuYW1lcy4gU2V0dGluZyB0aGUKIyBjYWNoZSBzaXplIHRvIHplcm8gZGlzYWJsZXMgY2FjaGluZy4KI2NhY2hlLXNpemU9NjU1MzY="}, "filesystem": "root"}, {"path": "/home/core/download-nomad.sh", "mode": 493, "contents": {"source": "data:text/plain;charset=utf-8;base64,IyEvYmluL2Jhc2gKd2hpbGUgISBwaW5nIC1jIDEgLVcgMSA4LjguOC44OyBkbwogIGVjaG8gIldhaXRpbmcgZm9yIDguOC44LjggLSBuZXR3b3JrIGludGVyZmFjZSBtaWdodCBiZSBkb3duLi4uIgogIHNsZWVwIDEKZG9uZQoKaWYgWyAhIC1mICIvb3B0L2Jpbi9ub21hZCIgXQp0aGVuCiAgZWNobyAiSW5zdGFsbGluZyBOb21hZC4uLiIKICBjZCAvaG9tZS9jb3JlCiAgd2dldCBodHRwczovL3JlbGVhc2VzLmhhc2hpY29ycC5jb20vbm9tYWQvMC45LjMvbm9tYWRfMC45LjNfbGludXhfYW1kNjQuemlwCiAgbWtkaXIgLXAgL29wdC9iaW4KICB1bnppcCAtZCAvb3B0L2JpbiBub21hZF8wLjkuM19saW51eF9hbWQ2NC56aXAKZWxzZQogIGVjaG8gIkFscmVhZHkgaW5zdGFsbGVkIgpmaQ=="}, "filesystem": "root"}]}, "systemd": {"units": [{"dropins": [{"name": "10-sshd-port.conf", "contents": "[Socket]\nListenStream=\nListenStream=34"}], "enabled": true, "name": "sshd.socket"}, {"enabled": true, "name": "vmtoolsd.service", "contents": "[Unit]\nDescription=VMware Tools Agent\nDocumentation=https://github.com/vmware/open-vm-tools\nConditionVirtualization=vmware\n\n[Service]\nExecStartPre=/usr/bin/ln -sfT /usr/share/oem/vmware-tools /etc/vmware-tools\nExecStart=/usr/share/oem/bin/vmtoolsd\nTimeoutStopSec=5\nTimeoutStartSec=5\nPrivateTmp=true\nRestart=always\n\n[Install]\nWantedBy=multi-user.target"}, {"enabled": true, "name": "dnsmasq.service", "contents": "[Unit]\nDescription=Dnsmasq\nAfter=systemd-networkd-wait-online.service\nRequires=systemd-networkd-wait-online.service\n\n[Service]\nExecStart=/usr/bin/docker run --rm --net=host --name=dnsmasq -p 53:53/tcp -p 53:53/udp -v /etc/dnsmasq/dnsmasq.conf:/etc/dnsmasq/dnsmasq.conf:ro --cap-add=NET_ADMIN andyshinn/dnsmasq:2.75 --log-facility=- --conf-file=/etc/dnsmasq/dnsmasq.conf --log-queries -d\nExecStop=/usr/bin/docker stop dnsmasq\n\n# Ensure log messages are correctly tagged in the system log.\nSyslogIdentifier=dnsmasq\n\n# Auto-Restart the container after a crash.\nRestart=always\nRestartSec=30\nStartLimitBurst=3\nStartLimitIntervalSec=160\nLimitNOFILE=65536\nTasksMax=infinity\nTimeoutSec=30\n\n[Install]\n# make sure service is started after docker is up\nWantedBy=multi-user.target"}, {"enabled": true, "name": "consul.service", "contents": "[Unit]\nAfter=docker.device\nRequires=docker.service\n\n[Service]\nExecStartPre=/bin/sh -c 'until ping -c1 192.168.10.1; do sleep 1; done;'\nExecStartPre=-/usr/bin/docker rm -f consul\n\nExecStart=docker run --net=host --rm --name=consul -v consul-volume:/consul/data consul:1.5.2 agent -datacenter nyb1 -retry-join \"10.0.0.10\" -client=\"192.168.10.10\" -bind=\"192.168.10.10\"\n\nExecStop=/usr/bin/docker stop consul\n# Ensure log messages are correctly tagged in the system log.\nSyslogIdentifier=consul\n# Auto-Restart the container after a crash.\nRestart=always\n\n[Install]\n# make sure service is started after docker is up\nWantedBy=docker.service"}, {"enabled": true, "name": "nomad.service", "contents": "[Unit]\nDescription=Nomad\nDocumentation=https://nomadproject.io/docs/\nAfter=download-nomad.service\nRequires=docker.service\n\n[Service]\nKillMode=process\nKillSignal=SIGINT\nExecStartPre=/bin/sh -c 'until ping -c1 192.168.10.1; do sleep 1; done;'\nExecStart=/opt/bin/nomad agent -config /etc/nomad/nomad.hcl\nExecReload=/bin/kill -HUP $MAINPID\nRestart=on-failure\nRestartSec=30\nStartLimitBurst=3\nStartLimitIntervalSec=160\nLimitNOFILE=65536\nTasksMax=infinity\nTimeoutSec=30\n\n[Install]\nWantedBy=multi-user.target"}, {"enabled": true, "name": "download-nomad.service", "contents": "[Unit]\nAfter=systemd-networkd-wait-online.service\nRequires=systemd-networkd-wait-online.service\n\n[Service]\nType=oneshot\nExecStart=/bin/bash /home/core/download-nomad.sh\nRemainAfterExit=true\n\n[Install]\nWantedBy=multi-user.target"}, {"enabled": true, "name": "unlink-resolved.service", "contents": "[Unit]\nDescription=Unlink resolved\n# Define dependencies\nAfter=systemd-resolved.service\nRequires=systemd-resolved.service\n\n[Service]\nType=oneshot\nExecStartPre=-/bin/unlink /etc/resolv.conf\nExecStartPre=-/usr/bin/touch /etc/resolv.conf\nExecStart=/usr/bin/bash -c '/usr/bin/echo \"nameserver 127.0.0.1\" > /etc/resolv.conf'\nExecStart=/usr/bin/bash -c '/usr/bin/echo \"nameserver 8.8.8.8\" >> /etc/resolv.conf'\nExecStart=/usr/bin/bash -c '/usr/bin/echo \"nameserver 8.8.4.4\" >> /etc/resolv.conf'\nRemainAfterExit=true\n\n[Install]\nWantedBy=multi-user.target"}, {"enabled": true, "name": "var-vm-swapfile1.swap", "contents": "[Unit]\nDescription=Turn on swap\nRequires=create-swapfile.service\nAfter=create-swapfile.service\n\n[Swap]\nWhat=/var/vm/swapfile1\n\n[Install]\nWantedBy=multi-user.target"}, {"enabled": true, "name": "create-swapfile.service", "contents": "[Unit]\nDescription=Create a swapfile\nRequiresMountsFor=/var\nConditionPathExists=!/var/vm/swapfile1\n\n[Service]\nType=oneshot\nExecStart=/usr/bin/mkdir -p /var/vm\nExecStart=/usr/bin/fallocate -l 1024m /var/vm/swapfile1\nExecStart=/usr/bin/chmod 600 /var/vm/swapfile1\nExecStart=/usr/sbin/mkswap /var/vm/swapfile1\nRemainAfterExit=true\n\n[Install]\nWantedBy=multi-user.target"}, {"enabled": false, "mask": true, "name": "locksmithd.service"}, {"enabled": false, "mask": true, "name": "update-engine.service"}, {"enabled": false, "mask": true, "name": "systemd-resolved.service"}]}, "ignition": {"version": "2.2.0"}}